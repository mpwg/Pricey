# M0.3: Basic Receipt List UI

**Duration**: Week 2-3 (5-7 days)  
**Priority**: P0 (Critical)  
**Story Points**: 13

## üìã User Story

**As a** user  
**I want to** view my uploaded receipts and their details  
**So that** I can track my purchases and verify OCR accuracy

## üéØ Objectives

Build a mobile-first, responsive frontend using Next.js that allows users to upload receipts, view a chronological list, and see detailed information about each receipt.

## ‚úÖ Acceptance Criteria

- [ ] Users can access the app from mobile browsers
- [ ] Users can upload receipts via a simple form
- [ ] Receipt list displays all uploaded receipts chronologically
- [ ] Each receipt shows: date, store, thumbnail, and total
- [ ] Users can click a receipt to view full details
- [ ] Receipt detail view shows all extracted items
- [ ] Processing status is clearly indicated
- [ ] Basic responsive design works on mobile and desktop
- [ ] App has basic styling (no full design system required)
- [ ] Loading states are shown for async operations

## üèóÔ∏è Technology Stack

- **Framework**: Next.js 14+ (App Router)
- **UI Library**: React 18+
- **Styling**: Tailwind CSS
- **Components**: shadcn/ui (basic components)
- **HTTP Client**: fetch API / axios
- **State Management**: React hooks (useState, useEffect)
- **Form Handling**: React Hook Form
- **Image Preview**: Next.js Image component

## üó∫Ô∏è Routes Structure

```
/                           ‚Üí Landing/upload page
/receipts                   ‚Üí Receipt list
/receipts/[id]              ‚Üí Receipt detail
/receipts/[id]/status       ‚Üí Processing status (auto-updates)
```

## üìù Tasks

### 1. Next.js App Setup

- [ ] Create `apps/web` workspace
- [ ] Initialize Next.js with TypeScript
  - [ ] `npx create-next-app@latest web --typescript`
  - [ ] Use App Router
  - [ ] Enable Tailwind CSS
- [ ] Configure Tailwind CSS
  - [ ] Customize theme
  - [ ] Add custom colors
  - [ ] Configure responsive breakpoints
- [ ] Install and configure shadcn/ui
  - [ ] `npx shadcn-ui@latest init`
  - [ ] Install core components (Button, Card, Badge, etc.)
- [ ] Set up environment variables
  - [ ] `NEXT_PUBLIC_API_URL`
  - [ ] Create `.env.local.example`
- [ ] Configure Next.js settings
  - [ ] Enable image optimization
  - [ ] Configure API base URL
  - [ ] Set up TypeScript paths
- [ ] Create basic layout component
  - [ ] Header with logo
  - [ ] Navigation
  - [ ] Footer
- [ ] Add metadata and SEO
  - [ ] Page titles
  - [ ] Meta descriptions
  - [ ] Open Graph tags

**Files to Create:**

- `apps/web/package.json`
- `apps/web/tailwind.config.ts`
- `apps/web/next.config.js`
- `apps/web/src/app/layout.tsx`
- `apps/web/src/components/layout/Header.tsx`
- `apps/web/src/components/layout/Footer.tsx`

### 2. Receipt Upload Page (`/`)

- [ ] Create landing page layout
  - [ ] `app/page.tsx`
  - [ ] Hero section
  - [ ] Upload section
  - [ ] Features section (optional)
- [ ] Add value proposition section
  - [ ] Headline
  - [ ] Subheadline
  - [ ] Benefits list
- [ ] Implement file upload form
  - [ ] File input component
  - [ ] Drag & drop support
  - [ ] Image preview before upload
  - [ ] File validation (client-side)
  - [ ] Upload button
- [ ] Add mobile camera capture
  - [ ] `<input type="file" accept="image/*" capture="environment" />`
  - [ ] Mobile-optimized UI
- [ ] Implement upload logic
  - [ ] Create FormData
  - [ ] POST to `/api/v1/receipts/upload`
  - [ ] Show upload progress
  - [ ] Handle success/error
- [ ] Add loading states
  - [ ] Spinner during upload
  - [ ] Progress bar (optional)
  - [ ] Disable form during upload
- [ ] Show success/error messages
  - [ ] Toast notifications
  - [ ] Inline error messages
- [ ] Redirect to receipt list after upload
  - [ ] Or to receipt detail page
  - [ ] With success message

**Files to Create:**

- `apps/web/src/app/page.tsx`
- `apps/web/src/components/upload/UploadForm.tsx`
- `apps/web/src/components/upload/ImagePreview.tsx`
- `apps/web/src/lib/api.ts`

**Example Upload Component:**

```typescript
"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import { Button } from "@/components/ui/button";

export function UploadForm() {
  const [file, setFile] = useState<File | null>(null);
  const [uploading, setUploading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const router = useRouter();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!file) return;

    setUploading(true);
    setError(null);

    try {
      const formData = new FormData();
      formData.append("image", file);

      const response = await fetch(
        `${process.env.NEXT_PUBLIC_API_URL}/api/v1/receipts/upload`,
        {
          method: "POST",
          body: formData,
        }
      );

      if (!response.ok) {
        throw new Error("Upload failed");
      }

      const data = await response.json();
      router.push(`/receipts/${data.id}`);
    } catch (err) {
      setError("Failed to upload receipt. Please try again.");
    } finally {
      setUploading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <div className="border-2 border-dashed rounded-lg p-8 text-center">
        <input
          type="file"
          accept="image/jpeg,image/png"
          onChange={(e) => setFile(e.target.files?.[0] || null)}
          className="hidden"
          id="receipt-upload"
        />
        <label htmlFor="receipt-upload" className="cursor-pointer">
          <div className="text-lg font-medium">
            {file ? file.name : "Choose a receipt or drag it here"}
          </div>
        </label>
      </div>

      {error && <div className="text-red-500">{error}</div>}

      <Button type="submit" disabled={!file || uploading} className="w-full">
        {uploading ? "Uploading..." : "Upload Receipt"}
      </Button>
    </form>
  );
}
```

### 3. Receipt List Page (`/receipts`)

- [ ] Create receipt list layout
  - [ ] `app/receipts/page.tsx`
  - [ ] Page header with title
  - [ ] Filter/sort controls (optional for MVP)
  - [ ] Grid layout for receipts
- [ ] Fetch receipts from API
  - [ ] `GET /api/v1/receipts`
  - [ ] Handle loading state
  - [ ] Handle errors
  - [ ] Parse response
- [ ] Display receipts chronologically
  - [ ] Newest first
  - [ ] Group by date (optional)
- [ ] Create receipt card component
  - [ ] Thumbnail image
  - [ ] Store name
  - [ ] Purchase date
  - [ ] Total amount
  - [ ] Status badge
  - [ ] Click handler
- [ ] Implement responsive grid
  - [ ] 1 column on mobile
  - [ ] 2 columns on tablet
  - [ ] 3 columns on desktop
- [ ] Add empty state
  - [ ] "No receipts yet" message
  - [ ] Call-to-action to upload
  - [ ] Illustration (optional)
- [ ] Add loading skeleton
  - [ ] Placeholder cards
  - [ ] Shimmer effect
- [ ] Add error state
  - [ ] Error message
  - [ ] Retry button
- [ ] Add "Upload New" button
  - [ ] Floating action button
  - [ ] Links to upload page

**Files to Create:**

- `apps/web/src/app/receipts/page.tsx`
- `apps/web/src/components/receipts/ReceiptCard.tsx`
- `apps/web/src/components/receipts/ReceiptList.tsx`
- `apps/web/src/components/ui/LoadingSkeleton.tsx`
- `apps/web/src/components/ui/EmptyState.tsx`

**Example Receipt Card:**

```typescript
import { Card } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { formatDate, formatCurrency } from "@/lib/utils";

interface ReceiptCardProps {
  receipt: {
    id: string;
    storeName?: string;
    purchaseDate?: string;
    totalAmount?: number;
    imageUrl: string;
    status: "processing" | "completed" | "failed";
  };
}

export function ReceiptCard({ receipt }: ReceiptCardProps) {
  return (
    <Card
      className="cursor-pointer hover:shadow-lg transition-shadow"
      onClick={() => (window.location.href = `/receipts/${receipt.id}`)}
    >
      <div className="aspect-[3/4] relative bg-gray-100">
        <img
          src={receipt.imageUrl}
          alt="Receipt"
          className="object-cover w-full h-full"
        />
        <div className="absolute top-2 right-2">
          <StatusBadge status={receipt.status} />
        </div>
      </div>
      <div className="p-4 space-y-2">
        <div className="font-semibold">
          {receipt.storeName || "Processing..."}
        </div>
        <div className="text-sm text-gray-600">
          {receipt.purchaseDate
            ? formatDate(receipt.purchaseDate)
            : "Date pending..."}
        </div>
        <div className="text-lg font-bold">
          {receipt.totalAmount ? formatCurrency(receipt.totalAmount) : "‚Äî"}
        </div>
      </div>
    </Card>
  );
}
```

### 4. Receipt Detail Page (`/receipts/[id]`)

- [ ] Create detail page layout
  - [ ] `app/receipts/[id]/page.tsx`
  - [ ] Back button to list
  - [ ] Receipt image section
  - [ ] Metadata section
  - [ ] Items table section
- [ ] Fetch receipt details from API
  - [ ] `GET /api/v1/receipts/:id`
  - [ ] Handle loading state
  - [ ] Handle 404 errors
- [ ] Display full-size receipt image
  - [ ] Use Next.js Image component
  - [ ] Zoomable viewer
  - [ ] Pinch to zoom on mobile
  - [ ] Download button (optional)
- [ ] Show receipt metadata
  - [ ] Store name with icon/logo
  - [ ] Purchase date
  - [ ] Total amount
  - [ ] OCR confidence score
  - [ ] Processing time
- [ ] Display extracted items table
  - [ ] Item name column
  - [ ] Quantity column
  - [ ] Price column
  - [ ] Total column (qty √ó price)
  - [ ] Mobile-responsive table
- [ ] Show raw OCR text
  - [ ] Collapsible section
  - [ ] Monospace font
  - [ ] Copy button
- [ ] Add share button (optional)
- [ ] Handle loading and error states

**Files to Create:**

- `apps/web/src/app/receipts/[id]/page.tsx`
- `apps/web/src/components/receipts/ReceiptImage.tsx`
- `apps/web/src/components/receipts/ReceiptMetadata.tsx`
- `apps/web/src/components/receipts/ItemsTable.tsx`
- `apps/web/src/components/receipts/RawOcrText.tsx`

**Example Items Table:**

```typescript
interface Item {
  id: string;
  name: string;
  quantity: number;
  price: number;
}

export function ItemsTable({ items }: { items: Item[] }) {
  return (
    <div className="overflow-x-auto">
      <table className="w-full">
        <thead>
          <tr className="border-b">
            <th className="text-left p-2">Item</th>
            <th className="text-center p-2">Qty</th>
            <th className="text-right p-2">Price</th>
            <th className="text-right p-2">Total</th>
          </tr>
        </thead>
        <tbody>
          {items.map((item) => (
            <tr key={item.id} className="border-b">
              <td className="p-2">{item.name}</td>
              <td className="text-center p-2">{item.quantity}</td>
              <td className="text-right p-2">{formatCurrency(item.price)}</td>
              <td className="text-right p-2">
                {formatCurrency(item.price * item.quantity)}
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}
```

### 5. Processing Status Indicator

- [ ] Create status badge component
  - [ ] "Processing" (yellow, spinner icon)
  - [ ] "Completed" (green, checkmark icon)
  - [ ] "Failed" (red, error icon)
- [ ] Implement auto-polling for processing receipts
  - [ ] Check status every 3 seconds
  - [ ] Stop when status is completed/failed
  - [ ] Update UI automatically
- [ ] Show processing progress
  - [ ] Progress bar (if available from API)
  - [ ] Estimated time remaining
- [ ] Handle processing failures
  - [ ] Show error message
  - [ ] Offer retry option

**Files to Create:**

- `apps/web/src/components/ui/StatusBadge.tsx`
- `apps/web/src/hooks/useReceiptStatus.ts`

**Example Status Hook:**

```typescript
import { useEffect, useState } from 'react';

export function useReceiptStatus(receiptId: string, initialStatus: string) {
  const [status, setStatus] = useState(initialStatus);
  const [polling, setPolling] = useState(initialStatus === 'processing');

  useEffect(() => {
    if (!polling) return;

    const interval = setInterval(async () => {
      const response = await fetch(
        `${process.env.NEXT_PUBLIC_API_URL}/api/v1/receipts/${receiptId}/status`
      );
      const data = await response.json();

      setStatus(data.status);

      if (data.status !== 'processing') {
        setPolling(false);
      }
    }, 3000);

    return () => clearInterval(interval);
  }, [receiptId, polling]);

  return { status, polling };
}
```

### 6. Basic Styling & Responsive Design

- [ ] Implement mobile-first approach
  - [ ] Start with mobile styles
  - [ ] Add tablet/desktop with media queries
- [ ] Create responsive grid layouts
- [ ] Style forms properly
  - [ ] Input fields
  - [ ] Buttons
  - [ ] Labels
  - [ ] Error messages
- [ ] Add hover states
  - [ ] Cards
  - [ ] Buttons
  - [ ] Links
- [ ] Ensure touch targets ‚â•44x44px
  - [ ] Buttons
  - [ ] Links
  - [ ] Cards
- [ ] Test on various screen sizes
  - [ ] iPhone SE (375px)
  - [ ] iPhone 14 (390px)
  - [ ] iPad (768px)
  - [ ] Desktop (1920px)
- [ ] Define color palette
  - [ ] Primary color
  - [ ] Secondary color
  - [ ] Success/error/warning colors
  - [ ] Neutral grays
- [ ] Use consistent spacing scale
  - [ ] 4px base unit
  - [ ] 8px, 16px, 24px, 32px, etc.

**Tailwind Config:**

```typescript
// tailwind.config.ts
export default {
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#3b82f6',
          600: '#2563eb',
          700: '#1d4ed8',
        },
      },
    },
  },
};
```

### 7. Error Handling & User Feedback

- [ ] Install toast library (sonner or react-hot-toast)
- [ ] Show toast notifications
  - [ ] Upload success
  - [ ] Upload failure
  - [ ] Network errors
- [ ] Display inline error messages
  - [ ] Form validation errors
  - [ ] API errors
- [ ] Handle network errors gracefully
  - [ ] Offline message
  - [ ] Retry options
- [ ] Show retry options for failed requests
- [ ] Add 404 page for invalid receipt IDs
- [ ] Add error boundary for React errors
- [ ] Handle empty states with helpful messages

**Files to Create:**

- `apps/web/src/components/ui/Toast.tsx`
- `apps/web/src/app/not-found.tsx`
- `apps/web/src/app/error.tsx`

### 8. Performance Optimization

- [ ] Use Next.js Image component
  - [ ] Automatic optimization
  - [ ] Lazy loading
  - [ ] Responsive sizes
- [ ] Implement lazy loading for images
- [ ] Add loading skeletons
  - [ ] Better perceived performance
  - [ ] Match final component layout
- [ ] Minimize initial bundle size
  - [ ] Code splitting by route
  - [ ] Dynamic imports for heavy components
- [ ] Use React.memo for expensive components
- [ ] Implement debouncing for search (if added)
- [ ] Optimize Tailwind CSS
  - [ ] Remove unused classes
  - [ ] Minimize CSS bundle

### 9. Testing

- [ ] Install testing libraries
  - [ ] Vitest
  - [ ] React Testing Library
  - [ ] Playwright (E2E)
- [ ] Write component tests
  - [ ] UploadForm component
  - [ ] ReceiptCard component
  - [ ] ItemsTable component
  - [ ] StatusBadge component
- [ ] Write E2E tests
  - [ ] Upload receipt flow
  - [ ] View receipt list
  - [ ] View receipt details
  - [ ] Handle errors
- [ ] Test responsive design
  - [ ] Mobile breakpoints
  - [ ] Tablet breakpoints
  - [ ] Desktop breakpoints
- [ ] Test accessibility
  - [ ] Keyboard navigation
  - [ ] Screen reader compatibility
  - [ ] Color contrast
- [ ] Test error scenarios
  - [ ] Network failures
  - [ ] Invalid data
  - [ ] Missing receipts

**Files to Create:**

- `apps/web/src/components/__tests__/UploadForm.test.tsx`
- `apps/web/src/components/__tests__/ReceiptCard.test.tsx`
- `apps/web/e2e/upload-flow.spec.ts`

## üß™ Testing Checklist

### Functional Testing

- [ ] Upload receipt ‚Üí appears in list
- [ ] Click receipt ‚Üí shows detail page
- [ ] Upload multiple receipts ‚Üí all appear
- [ ] Processing receipt ‚Üí status updates automatically
- [ ] Failed upload ‚Üí error message displayed
- [ ] No receipts ‚Üí empty state shown
- [ ] Back button ‚Üí returns to list
- [ ] Mobile camera ‚Üí captures receipt

### Responsive Testing

- [ ] Works on iPhone SE (375px)
- [ ] Works on iPhone 14 Pro (390px)
- [ ] Works on iPad (768px)
- [ ] Works on desktop (1920px)
- [ ] Touch interactions work on mobile
- [ ] Images scale appropriately
- [ ] Text is readable at all sizes
- [ ] No horizontal scrolling

### Accessibility Testing

- [ ] All images have alt text
- [ ] Form inputs have labels
- [ ] Keyboard navigation works
  - [ ] Tab through forms
  - [ ] Enter to submit
  - [ ] Esc to close modals
- [ ] Focus indicators visible
- [ ] Color contrast meets WCAG AA (4.5:1)
- [ ] Screen reader announces status changes
- [ ] ARIA labels where appropriate

### Performance Testing

- [ ] Lighthouse performance score > 80
- [ ] First Contentful Paint < 2s
- [ ] Largest Contentful Paint < 3s
- [ ] Cumulative Layout Shift < 0.1
- [ ] Time to Interactive < 3.5s
- [ ] Initial bundle size < 500KB

## üìä Success Metrics

- **Mobile Usability**: Lighthouse mobile score > 90
- **Load Time**: < 3 seconds on 4G
- **Upload Success Rate**: > 95% (no client errors)
- **User Completion**: 80%+ complete upload flow
- **Error Rate**: < 5% of interactions
- **Accessibility**: Axe score 100 (no violations)

## üîó Dependencies

- **Depends on**:
  - M0.1 (Infrastructure Setup)
  - M0.2 (Receipt Upload & OCR)
- **Blocks**: M0.4 (MVP Launch Preparation)

## ‚ö†Ô∏è Known Technical Debt

1. **No Authentication**: All receipts are public/unscoped
2. **No Pagination**: Limited to recent receipts only
3. **Minimal Error Handling**: Basic error messages
4. **No Design System**: Basic styling without comprehensive library
5. **No Offline Support**: PWA features deferred to Phase 1
6. **No Manual Editing**: Can't correct OCR mistakes
7. **No Search/Filtering**: Basic list only

_These will be addressed in Phase 1 (Beta)_

## üìö Reference Documentation

- [Next.js 14 Documentation](https://nextjs.org/docs)
- [shadcn/ui Components](https://ui.shadcn.com/)
- [Tailwind CSS](https://tailwindcss.com/docs)
- [React Hook Form](https://react-hook-form.com/)

## üéØ Definition of Done

- [ ] All tasks completed
- [ ] All acceptance criteria met
- [ ] Responsive on mobile and desktop
- [ ] All tests passing
- [ ] Lighthouse score > 80
- [ ] Accessibility score 100
- [ ] Code reviewed
- [ ] Deployed to staging
